<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rUv Dev Test Page</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">rUv Dev Environment</h1>
            <div id="wsStatus" class="inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold bg-gray-200">
                Connecting...
            </div>
        </header>

        <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-6">
            <div class="space-y-6">
                <!-- Server Status -->
                <div class="border-b pb-4">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">Server Status</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"></div>
                            <span>WebSocket</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                            <span>Live Reload</span>
                        </div>
                    </div>
                </div>

                <!-- Current Time -->
                <div class="border-b pb-4">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">Current Time</h2>
                    <div id="currentTime" class="text-2xl font-mono"></div>
                </div>

                <!-- Test Section -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">Live Reload Test</h2>
                    <p class="text-gray-600 mb-4">
                        Edit the test.html file to see live reload in action.
                        The page will automatically refresh when you save changes.
                    </p>
                    <div class="bg-gray-100 p-4 rounded">
                        <code class="text-sm">Last Reload: <span id="lastReload"></span></code>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Update current time
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleTimeString();
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Set last reload time
        document.getElementById('lastReload').textContent = new Date().toLocaleTimeString();

        // WebSocket status indicator
        const wsStatus = document.getElementById('wsStatus');
        function updateWsStatus(status, color) {
            wsStatus.textContent = status;
            wsStatus.className = `inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold ${color}`;
        }

        // Initialize WebSocket connection
        function initWebSocket() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = `${protocol}//${window.location.host}`;
            const ws = new WebSocket(wsUrl);

            ws.onopen = () => {
                console.log('WebSocket connected');
                updateWsStatus('Connected', 'bg-green-100 text-green-800');
            };

            ws.onclose = () => {
                console.log('WebSocket disconnected');
                updateWsStatus('Disconnected', 'bg-red-100 text-red-800');
                setTimeout(initWebSocket, 1000);
            };

            ws.onerror = (error) => {
                console.error('WebSocket error:', error);
                updateWsStatus('Error', 'bg-red-100 text-red-800');
            };

            ws.onmessage = (event) => {
                if (event.data === 'reload') {
                    console.log('Reloading page...');
                    window.location.reload();
                }
            };
        }

        // Start WebSocket connection
        initWebSocket();
    </script>
</body>
</html>
